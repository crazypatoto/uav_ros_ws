<?xml version="1.0"?>
<launch>
    <!-- Use gazebo simulation time -->
    <param name="/use_sim_time" value="true" />
    <!-- <env name="PX4_SIM_SPEED_FACTOR" value="1.0" /> -->

    <!-- UAV inital positions -->
    <arg name="Yaw_0" default="0" />
    <arg name="Yaw_1" default="45" />
    <arg name="Yaw_2" default="90" />
    <arg name="Yaw_3" default="135" />
    <arg name="flying_altitude" default="10" />


    <!-- UAV0 -->
    <group ns="uav0">
        <!-- UAV Controller -->
        <node pkg="uav_controller" type="uav_controller_node" name="uav_controller" output="screen">
            <!--Params specific for Iris copter-->
            <param name="attctrl_constant" value="0.3" />
            <param name="normalizedthrust_constant" value="0.062" />
            <param name="normalizedthrust_offset" value="0.1" />
            <param name="Kp_x" value="5.0" />
            <param name="Kp_y" value="5.0" />
            <param name="Kp_z" value="3.0" />
            <param name="Kv_x" value="5.0" />
            <param name="Kv_y" value="5.0" />
            <param name="Kv_z" value="3.0" />
            <param name="initTargetPos_z" value="$(arg flying_altitude)" />
            <param name="auto_takeoff" value="true" />
            <param name="target_yaw" value="$(arg Yaw_0)" />
        </node>
    </group>

    <!-- UAV1 -->
    <group ns="uav1">
        <!-- UAV Controller -->
        <node pkg="uav_controller" type="uav_controller_node" name="uav_controller" output="screen">
            <!--Params specific for Iris copter-->
            <param name="attctrl_constant" value="0.3" />
            <param name="normalizedthrust_constant" value="0.062" />
            <param name="normalizedthrust_offset" value="0.1" />
            <param name="Kp_x" value="5.0" />
            <param name="Kp_y" value="5.0" />
            <param name="Kp_z" value="3.0" />
            <param name="Kv_x" value="5.0" />
            <param name="Kv_y" value="5.0" />
            <param name="Kv_z" value="3.0" />
            <param name="initTargetPos_z" value="$(arg flying_altitude)" />
            <param name="auto_takeoff" value="true" />
            <param name="target_yaw" value="$(arg Yaw_1)" />
        </node>
    </group>

    <!-- UAV2 -->
    <group ns="uav2">
        <!-- UAV Controller -->
        <node pkg="uav_controller" type="uav_controller_node" name="uav_controller" output="screen">
            <!--Params specific for Iris copter-->
            <param name="attctrl_constant" value="0.3" />
            <param name="normalizedthrust_constant" value="0.062" />
            <param name="normalizedthrust_offset" value="0.1" />
            <param name="Kp_x" value="5.0" />
            <param name="Kp_y" value="5.0" />
            <param name="Kp_z" value="3.0" />
            <param name="Kv_x" value="5.0" />
            <param name="Kv_y" value="5.0" />
            <param name="Kv_z" value="3.0" />
            <param name="initTargetPos_z" value="$(arg flying_altitude)" />
            <param name="auto_takeoff" value="true" />
            <param name="target_yaw" value="$(arg Yaw_2)" />
        </node>
    </group>

    <!-- UAV3 -->
    <group ns="uav3">
        <!-- UAV Controller -->
        <node pkg="uav_controller" type="uav_controller_node" name="uav_controller" output="screen">
            <!--Params specific for Iris copter-->
            <param name="attctrl_constant" value="0.3" />
            <param name="normalizedthrust_constant" value="0.062" />
            <param name="normalizedthrust_offset" value="0.1" />
            <param name="Kp_x" value="5.0" />
            <param name="Kp_y" value="5.0" />
            <param name="Kp_z" value="3.0" />
            <param name="Kv_x" value="5.0" />
            <param name="Kv_y" value="5.0" />
            <param name="Kv_z" value="3.0" />
            <param name="initTargetPos_z" value="$(arg flying_altitude)" />
            <param name="auto_takeoff" value="true" />
            <param name="target_yaw" value="$(arg Yaw_3)" />
        </node>
    </group>


</launch> <!-- to add more UAVs (up to 10):
Increase the id
Change the name space
Set the FCU to default="udp://:14540+id@localhost:14550+id"
Set the malink_udp_port to 14560+id) -->